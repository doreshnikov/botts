# Bot TS (name pending, bot sucks)

### Update

Большая часть всего, что написано ниже, уже неактуальна. Кидайтесь в свой компьютер 
- `make run icount=2`

и радуйтесь жизни. Перед этим вам правда придется поставить `Docker` и `poetry`.

### Установка 

<span style="color: red">Обратите внимание, что</span> 1. не стоит ожидать, 
что это чудовище умеет нормально устанавливаться и/или запускаться, 2. в идеале 
неплохо иметь докер, чтобы это запустить (пока нет dummy-инвокера)

1. Работает на `python 3.11`. Каким-то чудом aiogram справился поддержать `python 3.12`,
но гарантий, что на нем заведется, не даю (хотя сам обновил зависимости, чтобы они хотя бы 
корректно ставились)
2. Часть зависимостей в [requirements.txt](requirements.txt) 
на самом деле не требуется (можно спокойно удалять `process_isolation` 
и скорее всего можно удалить `pandas`, искренне не помню, зачем он тут)
3. Учитывая все вышесказанное,
```bash 
python -m pip install -r requirements.txt
```
4. Перед запуском стоит убедиться, что Docker Daemon запущен 
(platform dependent, используйте гугл, если вы на винде &ndash; просто сдайтесь) &ndash; в любом случае 
пока что без докера невозможно отправлять посылки на тестирование. Тем не менее, если 
вам не понадобится проверять тестирование, можно обойтись и без докера.

Поздравляю, вы успешно поставили все необходимое (наверное). 

Теперь можно перейти к худшей из двух частей.

### Запуск

1. Сделайте себе тестового бота в тг (обратитесь к [@BotFather](https://t.me/BotFather))
2. Положите в корне проекта файл `config.toml` (не спрашивайте, почему toml, у меня проблемы с головой)
3. Внимательно посмотрите в [config.example.toml](config.example.toml):
```toml
[sheets]
course_table_url = '<url to course export table>'

[bot]
token = '<main bot token>'
debug_token = '<debug bot token>'
admin_id = <your id>
```
  - Первая настройка ничего не делает, игнорируйте
  - Подставьте токен вашего бота и ваш айди в телеграме (можете спросить [@my_id_bot](https://t.me/my_id_bot))
  - Дебажный токен тоже можно игнорировать

#### Дальше чуть сложнее

4. Если вам не нужно проверять тестирование (да и оно пока не работает, я же его сломал), 
забейте на докер, положите в [scripts/invokers](scripts/invokers) файлик `invokers.json` следующего вида:
```json
{} // (да, это все)
```
5. После чего вроде как все должно запускаться через `python -m botts.bot.main`
6. Иначе можно запускать через `./run.sh` или `./run.cmd`

#### Ну и...

7. Если ничего не получилось и все попадало, а ваш комп умер, очень жаль, вы проиграли.
Я уже больше полугода это не запускал. По мере того, как буду это оживлять, буду пополнять этот 
ридми более человеческими инструкциями